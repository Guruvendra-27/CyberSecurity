# Dynamic Analysis Report: Ransomware.wannacry.exe

## Overview
This report presents the findings of a dynamic analysis conducted on the ransomware sample "Ransomware.wannacry.exe." The goal is to document its activities, identify malicious behaviors, and provide actionable recommendations for mitigation.

---

## Tool: **Procmon**

### **Registry Activities**
The ransomware made numerous modifications to the Windows Registry. This indicates potential attempts to:
- Establish persistence by adding startup entries.
- Modify security settings to disable system defenses.
  
  ![procmon_registry](https://github.com/user-attachments/assets/4bbefa8a-4fa8-4ff5-9d87-502a6027cbf9)



---

### **File System Activities**
Significant file system activities were observed, including:
- Encryption of files with a unique extension.
- Creation of ransom note files in affected directories.

  ![procmon_file](https://github.com/user-attachments/assets/64dcc7c9-0dd5-470b-beb9-10d9c83d6340)


---

### **Network Activities**
Network traces revealed:
- Attempts to communicate with a command-and-control (C2) server.
- DNS queries for suspicious domains, indicating potential data exfiltration or key exchange for encryption.
  
  ![procmon_network](https://github.com/user-attachments/assets/25f9dca9-fb07-4dd4-a871-27da37aae6a3)


---

### **Process and Thread Activities**
Observed process activities include:
- Spawning multiple child processes for lateral movement and execution.
- Termination of security-related processes to bypass defenses.

  ![procmon_process](https://github.com/user-attachments/assets/2a249eb7-c7bf-42c9-a373-b7309f8d0e30)


---

### **Profiling Events**
Profiling events indicate:
- The ransomware executing high-privilege operations to gain control over the system.

  ![procmon_profile](https://github.com/user-attachments/assets/13d8d820-e313-45a5-afcf-2bfdeaa7d458)


The collected data confirms that the system has been compromised by ransomware.

---

## Tool: **Wireshark**

### **Network Traffic Analysis**
Captured traffic reveals communication with malicious domains.

Example malicious URL:
```
hxxp[://]www[.]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com/
```

![wireshark](https://github.com/user-attachments/assets/0bc0861b-a011-4161-b113-3f32496466d8)


---

## **Open Source Intelligence**

### **VirusTotal**
VirusTotal analysis identified the following indicators:
- Malicious URL: [VirusTotal URL](https://www.virustotal.com/gui/url/3f84099733746c597977fbac91e175a9165aa0ee431b222edf390fd51b4706b9/detection)
- IP Address: `104[.]16[.]166[.]228`

   ![VirusTotal - URL](https://github.com/user-attachments/assets/176e32f1-f7d0-4b1d-9f8c-52f1a39d083a)
   ![VirusTotal - ip](https://github.com/user-attachments/assets/60526329-8fac-4161-b7c4-5f67759c617b)


---

## **Conclusion and Recommendations**

### **Conclusion**
The analysis confirms that the system has been compromised by the ransomware "Ransomware.wannacry.exe." Its activities include encryption of files, registry modifications, and communication with malicious domains.

### **Recommendations**
1. **Immediate Isolation:** Disconnect the affected system from the network to prevent further spread.
2. **System Reimaging:** Reinstall the operating system to remove the ransomware entirely.
3. **Block Malicious Indicators:**
   - Blacklist the identified URL: `hxxp[://]www[.]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com/`
   - Block IP address: `104[.]16[.]166[.]228`
4. **Reset Credentials:** Change all user passwords to mitigate unauthorized access.
5. **Enhance Defenses:** Deploy endpoint protection tools and monitor network traffic for suspicious activities.
6. **Backup Restoration:** Restore affected files from secure backups to avoid paying the ransom.

---

